\subsection{Расчет производительности модуля криптографии iOS-клиента}
\label{sec:eng:performance}

В рамках данного раздела будут произведены измерения производительности функций, которые предоставляет в своём \gls{api} модуль авторизации. Все измерения будут производиться при помощи фреймворка для тестов \textit{XCTest}, рассмотренного в пункте \ref{sec:testing:tech:xctest}. На каждый метод \gls{api} будет написан тестовый метод, который работает по следующему алгоритму:

\begin{itemize}
	\item подготавливает необходимые данные;
	\item запускает тестовый код для подготовки окружения;
	\item делегирует \textit{XCTest} запуск тестового кода 10 раз с замером потраченного времени на каждую попытку.
\end{itemize}

\input{sections/052-calculations/paragraphs/rsakeygen}
\input{sections/052-calculations/paragraphs/rsaenc}
\newpage
\input{sections/052-calculations/paragraphs/aesenc}

В таблице \ref{sec:eng:performance:aesenc:result} приведены данные по всем измерениям. Для удобства использвоания значений, все результаты были увеличины в 10 раз. Важно отметить, что некоторые методы используются чаще остальных, поэтому разница между значениями может невилироваться частотой использования, например, генерация пары \textit{RSA} ключей выполняется только при первой авторизации в клиенте, в то время как генерация \textit{AES} ключа происходит при отправке каждого сообщения. Это же касается расшифровки сообщения: \textit{RSA} дешифрование применяется только при получении сообщения на фоновом потоке, а дальнейшее отображение (которое может повторяться столько раз, сколько сообщение будет попадать на экран) использует \textit{AES} дешифрование на главном потоке.

\begin{table}[!ht]
  \caption{Результаты расчетов производительности модуля криптографии iOS-клиента}
  \label{sec:eng:performance:aesenc:result}
  \centering
  \begin{tabularx}{\linewidth}{
    |>{\hsize=1.9\hsize}X|
    >{\centering\arraybackslash\hsize=0.7\hsize}X|
    >{\centering\arraybackslash\hsize=0.7\hsize}X|
    >{\centering\arraybackslash\hsize=0.7\hsize}X|
  }
	\hline
 \begin{center}Название метода\end{center} & Максимальное значение &  Минимальное значение &  Среднее значение \\
 \hline
 rsaKeyGeneration & \num{62.4} & \num{11.3} & \num{32.1} \\
 \hline
 aesKeyGeneration & \num{0.00323} & \num{0.0000127} & \num{0.000357} \\
 \hline
 aesEncrypt & \num{0.000229} & \num{0.0000448} & \num{0.0000565} \\
 \hline
 aesDecrypt & \num{0.000411} & \num{0.000034} & \num{0.000117} \\
 \hline
 rsaEncrypt & \num{0.00423} & \num{0.00281} & \num{0.00352} \\
 \hline
 rsaDecrypt & \num{0.236} & \num{0.224} & \num{0.228} \\
 \hline
  \end{tabularx}
\end{table}

Как видно по результатам тестов, методы, связанные с \textit{RSA} шифрованием, работают значительно медленнее аналогичных, использующих \textit{AES}. Данное поведение является ожидаемым, именно поэтому при шифровании сообщения, генерируется \textit{AES} ключ, который шифруется для каждого получателя, а само сообщение шифруется \textit{AES} ключом.